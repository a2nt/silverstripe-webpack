---
Name: webapp-base-graphql
After: graphqlconfig
---
SilverStripe\Control\Director:
  rules:
    'graphql': '%$SilverStripe\GraphQL\Controller.default'

SilverStripe\GraphQL\Controller:
  cors:
    Enabled: true
    Allow-Origin: '*'
    Allow-Headers: 'Authorization, Content-Type, Content-Language, apikey'
    Allow-Methods: 'GET, PUT, DELETE, OPTIONS, POST'
    #Allow-Credentials: 'true'
    Max-Age: 600 # 600 seconds = 10 minutes.

SilverStripe\GraphQL\Auth\Handler:
  authenticators:
    - class: Site\GraphQL\APIKeyAuthenticator
      priority: 30

SilverStripe\GraphQL\Manager.default:
  properties:
    Middlewares:
      APIKeyMiddleware: Site\GraphQL\APIKeyMiddleware

SilverStripe\GraphQL\Manager:
  schemas:
    default:
      types:
        member: 'Site\GraphQL\MemberTypeCreator'
        page: 'Site\GraphQL\PageTypeCreator'
        element: 'Site\GraphQL\ElementTypeCreator'
      queries:
        readPages: 'Site\GraphQL\PaginatedReadPagesQueryCreator'
        readMembers: 'Site\GraphQL\ReadMembersQueryCreator'
        paginatedReadMembers: 'Site\GraphQL\PaginatedReadMembersQueryCreator'
